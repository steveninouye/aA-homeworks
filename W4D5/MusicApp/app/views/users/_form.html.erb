<% if type == "edit"
  method = "patch"
  url = users_url(user)
  button_text = "Update User"
elsif type == "new"
  method = "post"
  url = users_url
  button_text = "Create User"
elsif type == "login"
  method = "post"
  url = session_url
  button_text = "Log In"
end %>

<form action="<%= url %>" method="post">
  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <input type="hidden" name="_method" value="<%= method %>">

  <label>Email:
    <input type="text" name="user[email]" value="<%= user.email %>">
  </label>

  <label>Password:
    <input type="password" name="user[password]">
  </label>
<% if type == "edit" %>
  <label>New Password:
    <input type="password" name="user[new_password]">
  </label>
<% end %>
<% unless type == "login" %>
  <label>Validate Password:
    <input type="password" name="user[validate_new_password]">
  </label>
<% end %>
  <input type="submit" value"<%= button_text %>">
</form>
